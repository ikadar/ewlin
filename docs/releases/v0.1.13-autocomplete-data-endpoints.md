# Release v0.1.13 – Autocomplete Data Endpoints

> **Status:** ✅ Released
>
> **Milestone:** M1
>
> **Release Date:** 2025-12-13
>
> **Git Tag:** `v0.1.13`

---

## Overview

This release adds lightweight API endpoints optimized for autocomplete functionality in the frontend DSL editor. These endpoints provide station names, provider names, and action types with minimal response payload for fast autocomplete suggestions.

---

## Prerequisites

- [x] `v0.1.12` Job Creation with DSL released
- [x] Station entity exists with name field
- [x] OutsourcedProvider entity exists with name and supportedActionTypes fields

---

## Scope

### In Scope

- GET /api/v1/stations/names - Station name list for autocomplete
- GET /api/v1/providers/names - Provider name list for autocomplete
- GET /api/v1/providers/action-types - Action type list for autocomplete
- Lightweight JSON responses (name/value only, no full entity data)
- Optional search/filter parameter for prefix matching

### Out of Scope

- Full entity CRUD endpoints (already exist)
- Pagination (autocomplete returns all matching items)
- Caching (future optimization)

---

## Related Documentation

### Requirements

| Document | Sections |
|----------|----------|
| [API Interface Drafts](../requirements/api-interface-drafts.md) | Section 9 - DSL Support API |

### Domain Model

| Document | Sections |
|----------|----------|
| [Domain Vocabulary](../domain-model/domain-vocabulary.md) | Station, OutsourcedProvider |

### Architecture

| Document | Sections |
|----------|----------|
| [Decision Records](../architecture/decision-records.md) | ADR-011 (Lezer Parser) |

---

## Technical Notes

### Response Format

All autocomplete endpoints return a simple array of strings:

```json
["Komori", "Massicot", "Heidelberg"]
```

### Search Parameter

Each endpoint supports an optional `q` query parameter for prefix filtering:

```
GET /api/v1/stations/names?q=Kom
→ ["Komori", "Komori XL"]
```

### Performance Target

- Response time: < 50ms
- No pagination needed (print shops typically have < 100 stations)

---

## Feature Checklist

### Station Autocomplete

- [x] **GET /api/v1/stations/names**
  - Description: Returns list of all station names for autocomplete
  - Files: `src/Controller/Api/V1/StationController.php`
  - Tests: `tests/Integration/Controller/Api/V1/StationControllerTest.php`

### Provider Autocomplete

- [x] **GET /api/v1/providers/names**
  - Description: Returns list of all provider names for autocomplete
  - Files: `src/Controller/Api/V1/ProviderController.php`
  - Tests: `tests/Integration/Controller/Api/V1/ProviderControllerTest.php`

- [x] **GET /api/v1/providers/action-types**
  - Description: Returns list of all unique action types across providers
  - Files: `src/Controller/Api/V1/ProviderController.php`
  - Tests: `tests/Integration/Controller/Api/V1/ProviderControllerTest.php`

### Repository Methods

- [x] **StationRepository::findAllNames()**
  - Description: Get all station names with optional prefix filter
  - Files: `src/Repository/StationRepository.php`
  - Tests: Covered by integration tests

- [x] **OutsourcedProviderRepository::findAllNames()**
  - Description: Get all provider names with optional prefix filter
  - Files: `src/Repository/OutsourcedProviderRepository.php`
  - Tests: Covered by integration tests

- [x] **OutsourcedProviderRepository::findAllActionTypes()**
  - Description: Get all unique action types with optional prefix filter
  - Files: `src/Repository/OutsourcedProviderRepository.php`
  - Tests: Covered by integration tests

---

## Testing Requirements

### Unit Tests

- [x] StationRepository::findAllNames() returns sorted names
- [x] StationRepository::findAllNames() with prefix filter
- [x] OutsourcedProviderRepository::findAllNames() returns sorted names
- [x] OutsourcedProviderRepository::findAllActionTypes() returns unique sorted types

### Integration Tests

- [x] GET /api/v1/stations/names returns 200 with array
- [x] GET /api/v1/stations/names?q=prefix filters results
- [x] GET /api/v1/providers/names returns 200 with array
- [x] GET /api/v1/providers/names?q=prefix filters results
- [x] GET /api/v1/providers/action-types returns 200 with array
- [x] GET /api/v1/providers/action-types?q=prefix filters results
- [x] Empty database returns empty array

### Manual Testing

- [x] Verify response format is simple string array
- [x] Verify response time < 50ms

---

## Definition of Done

All items must be checked for the release to be considered complete:

- [x] All feature checklist items completed
- [x] All unit tests passing
- [x] All integration tests passing
- [x] PHPStan level 8 passing
- [x] Code reviewed and approved
- [x] Documentation updated
- [x] CHANGELOG.md updated
- [x] Git tag created: `v0.1.13`
- [x] GitHub release created

---

## Release Notes Draft

```markdown
## v0.1.13 – Autocomplete Data Endpoints

**Release Date:** 2025-12-13

### Summary

Adds lightweight API endpoints for autocomplete functionality in the DSL editor, providing station names, provider names, and action types.

### What's New

- `GET /api/v1/stations/names` - Station name list
- `GET /api/v1/providers/names` - Provider name list
- `GET /api/v1/providers/action-types` - Action type list
- Optional `q` parameter for prefix filtering

### API Changes

**New Endpoints:**
```
GET /api/v1/stations/names?q=Kom → ["Komori", "Komori XL"]
GET /api/v1/providers/names?q=Cl → ["Clément"]
GET /api/v1/providers/action-types?q=Pel → ["Pelliculage"]
```

### Breaking Changes

None
```

---

## Post-Release

- [x] GitHub release created
- [x] Submodule reference updated in monorepo
- [x] Documentation verified
