# Release v0.0.7 – CI Fixes

> **Status:** ✅ Completed
>
> **Milestone:** M0 (Infrastructure & Foundation)
>
> **Release Date:** 2025-12-11
>
> **Git Tag:** `v0.0.7`

---

## Overview

This release addresses CI/CD pipeline failures discovered after the v0.0.6 release. All GitHub Actions workflows now pass successfully.

---

## Prerequisites

- [x] `v0.0.6` released (CI/CD Pipeline Foundation)
- [x] GitHub Actions workflows configured

---

## Scope

### In Scope

- CI workflow fixes for Node.js jobs
- CI workflow fixes for PHP jobs
- ESLint error fixes in source code
- Branch consolidation (development → main)

### Out of Scope

- New features
- API changes

---

## Changes

### CI Workflow Fixes

| Issue | Resolution |
|-------|------------|
| Tests failed due to missing package builds | Added `pnpm build` step before `pnpm test` |
| PHP job failed with missing `.env` | Added `.env` creation step with test credentials |
| PHP job failed with missing `DATABASE_URL` | Added DATABASE_URL to test environment |
| PHP Composer auto-scripts failed | Added `--no-scripts` flag to `composer install` |

### ESLint Fixes

| File | Issue | Fix |
|------|-------|-----|
| `App.tsx` | Missing return type | Added `ReactNode` return type |
| `main.tsx` | Non-null assertion | Replaced with guard clause |
| `api.ts` | Unnecessary conditional, void type | Used `||` and `undefined` |
| `job.ts` | Redundant type union | Fixed `ProofSentStatus` union |
| `time.ts` | Array type syntax | Changed `Array<T>` to `T[]` |
| `availability.ts` | Unused variables | Prefixed with `_` |
| `deadline.ts` | Template literal type | Wrapped number with `String()` |
| `group.ts` | Unused import, template literal | Removed import, wrapped number |

### ESLint Configuration

Added config file ignores to prevent parsing errors:
- `*.config.js`
- `*.config.ts`
- `**/eslint.config.js`
- `**/vite.config.ts`
- `**/vitest.config.ts`
- `**/postcss.config.js`

### Branch Consolidation

- Merged `v0.0.1-development-environment` branch into `main`
- All releases (v0.0.1 - v0.0.7) now accessible from `main` branch
- Git tags remain on their original commits

---

## Technical Notes

### CI Workflow Structure

```yaml
# .github/workflows/ci.yml
jobs:
  lint-node:     # ESLint check
  typecheck-node: # TypeScript compilation
  test-node:     # Vitest with package build
  build-frontend: # Vite production build
  lint-php:      # PHPStan (with --no-scripts)
  ci-success:    # Summary job for branch protection
```

### Package Build Order

The test job now builds packages before running tests to resolve inter-package dependencies:

```yaml
- name: Build packages
  run: pnpm build

- name: Run tests
  run: pnpm test
```

---

## Feature Checklist

### CI Fixes

- [x] **Add build step before tests**
  - Description: Packages must be built before tests run
  - Files: `.github/workflows/ci.yml`
  - Tests: CI passes

- [x] **Fix PHP environment setup**
  - Description: Create .env with test credentials
  - Files: `.github/workflows/ci.yml`
  - Tests: PHP lint job passes

- [x] **Disable Composer auto-scripts**
  - Description: Skip scripts that require full environment
  - Files: `.github/workflows/ci.yml`
  - Tests: PHP lint job completes

### Code Fixes

- [x] **Fix ESLint errors in frontend**
  - Files: `App.tsx`, `main.tsx`, `api.ts`
  - Tests: `pnpm lint` passes

- [x] **Fix ESLint errors in validator**
  - Files: `availability.ts`, `deadline.ts`, `group.ts`, `time.ts`
  - Tests: `pnpm lint` passes

- [x] **Fix ESLint errors in types**
  - Files: `job.ts`
  - Tests: `pnpm lint` passes

- [x] **Update ESLint config ignores**
  - Files: `eslint.config.js`
  - Tests: Config files no longer cause errors

### Branch Management

- [x] **Merge development branch to main**
  - Description: Consolidate all releases on main branch
  - Tests: `main` branch contains all releases

---

## Testing Requirements

### Verification

- [x] All CI jobs pass on `main` branch
- [x] All CI jobs pass on `v0.0.1-development-environment` branch
- [x] Docker build workflow succeeds
- [x] Local `pnpm lint` passes
- [x] Local `pnpm test` passes (29 tests)

---

## Definition of Done

- [x] All CI jobs passing
- [x] No ESLint errors
- [x] All tests passing (29 tests)
- [x] Main branch contains all releases
- [x] CHANGELOG.md updated
- [x] Git tag created: `v0.0.7`
- [x] GitHub release published

---

## Release Notes

```markdown
## v0.0.7 – CI Fixes

**Release Date:** 2025-12-11

### Fixed
- CI workflow: build packages before running tests
- ESLint errors in frontend and validator packages
- PHP lint job environment setup
- Branch consolidation (all releases now on main)

### Changed
- ESLint config now ignores config files
- PHP Composer install uses --no-scripts in CI
```

---

## Post-Release

- [x] GitHub release created
- [x] CI passing on main
- [x] M0 milestone fully complete
