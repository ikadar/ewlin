# Release v0.1.10 â€“ Job CRUD API

> **Status:** ðŸš€ Released
>
> **Milestone:** M1 (Core Domain MVP)
>
> **Target Date:** 2025-12-13
>
> **Git Tag:** `v0.1.10`

---

## Overview

This release implements the REST API endpoints for Job management, enabling create, read, update, and delete operations. This follows the existing patterns established in Station API (v0.1.1) and builds on the Job entity created in v0.1.9.

**Note:** The DSL-based task creation mentioned in the roadmap will be implemented in v0.1.12 (DSL Parser). This release provides basic Job CRUD without task management.

---

## Prerequisites

- [x] `v0.1.9` released (Job Entity)

---

## Scope

### In Scope

- POST /api/v1/jobs - Create a new job
- GET /api/v1/jobs - List jobs with pagination and filters
- GET /api/v1/jobs/{id} - Get a single job by ID
- PUT /api/v1/jobs/{id} - Update a job
- DELETE /api/v1/jobs/{id} - Delete a job
- OpenAPI/Swagger documentation
- Integration tests for all endpoints

### Out of Scope

- DSL parsing for task creation (v0.1.12)
- Task entity and task listing (v0.1.11)
- Job status workflow validation (future release)
- Job dependencies (v0.1.16)

---

## Related Documentation

### Domain Model

| Document | Sections |
|----------|----------|
| [Business Rules](../domain-model/business-rules.md) | BR-JOB-001, BR-JOB-003, BR-JOB-009 |

### Architecture

| Document | Sections |
|----------|----------|
| [Release Roadmap](../roadmap/release-roadmap.md) | v0.1.10 - Job API Endpoints |

---

## Technical Notes

### API Design

Following the Station API patterns:
- Controller in `App\Controller\Api\V1`
- DTOs in `App\DTO\Job` namespace
- Service layer for business logic
- OpenAPI attributes for documentation
- Symfony Validator for request validation

### Endpoints

| Method | Path | Description |
|--------|------|-------------|
| POST | /api/v1/jobs | Create a new job |
| GET | /api/v1/jobs | List jobs with filters |
| GET | /api/v1/jobs/{id} | Get job by ID |
| PUT | /api/v1/jobs/{id} | Update job |
| DELETE | /api/v1/jobs/{id} | Delete job |

### Request/Response Formats

**Create Job Request:**
```json
{
  "reference": "REF-001",
  "client": "Acme Corp",
  "description": "Business cards 500pcs",
  "workshopExitDate": "2024-01-15",
  "status": "draft"
}
```

**Job Response:**
```json
{
  "id": "uuid",
  "reference": "REF-001",
  "client": "Acme Corp",
  "description": "Business cards 500pcs",
  "status": "draft",
  "workshopExitDate": "2024-01-15",
  "color": "#E53935",
  "createdAt": "2024-01-01T10:00:00+00:00",
  "updatedAt": "2024-01-01T10:00:00+00:00"
}
```

**List Response:**
```json
{
  "items": [...],
  "total": 42,
  "page": 1,
  "limit": 20,
  "pages": 3
}
```

### Filter Parameters

| Parameter | Type | Description |
|-----------|------|-------------|
| search | string | Search in reference, client, description |
| status | string | Filter by status (draft, planned, in_progress, delayed, completed, cancelled) |
| page | integer | Page number (default: 1) |
| limit | integer | Items per page (default: 20, max: 100) |

---

## Feature Checklist

### DTOs

- [x] **CreateJobRequest**
  - Description: DTO for job creation with validation
  - Files: `src/DTO/Job/CreateJobRequest.php`

- [x] **UpdateJobRequest**
  - Description: DTO for job update with optional fields
  - Files: `src/DTO/Job/UpdateJobRequest.php`

- [x] **JobResponse**
  - Description: Response DTO with fromEntity factory
  - Files: `src/DTO/Job/JobResponse.php`

- [x] **JobListResponse**
  - Description: Paginated list response DTO
  - Files: `src/DTO/Job/JobListResponse.php`

### Service

- [x] **JobService**
  - Description: Service layer for Job business operations
  - Files: `src/Service/JobService.php`
  - Methods: create, findById, findAll, update, delete

### Controller

- [x] **JobController**
  - Description: REST API controller with OpenAPI docs
  - Files: `src/Controller/Api/V1/JobController.php`
  - Endpoints: POST, GET (list), GET (single), PUT, DELETE

### Repository Updates

- [x] **JobRepository::findAllPaginated**
  - Description: Add pagination support to existing repository
  - Files: `src/Repository/JobRepository.php`

---

## Testing Requirements

### Integration Tests

- [x] POST /api/v1/jobs - Create job
- [x] POST /api/v1/jobs - Validation errors
- [x] GET /api/v1/jobs - List all jobs
- [x] GET /api/v1/jobs - Filter by status
- [x] GET /api/v1/jobs - Search functionality
- [x] GET /api/v1/jobs - Pagination
- [x] GET /api/v1/jobs/{id} - Get existing job
- [x] GET /api/v1/jobs/{id} - 404 for non-existent
- [x] PUT /api/v1/jobs/{id} - Update job
- [x] PUT /api/v1/jobs/{id} - Terminal state validation
- [x] DELETE /api/v1/jobs/{id} - Delete job
- [x] DELETE /api/v1/jobs/{id} - 404 for non-existent

---

## Definition of Done

All items must be checked for the release to be considered complete:

- [x] All feature checklist items completed
- [x] All unit tests passing (508 tests, 1369 assertions)
- [x] All integration tests passing (23 job tests)
- [x] PHPStan level 8 passing
- [x] OpenAPI documentation complete (Swagger UI)
- [x] CHANGELOG.md updated
- [x] Git tag created: `v0.1.10`

---

## Release Notes Draft

```markdown
## v0.1.10 â€“ Job CRUD API

**Release Date:** 2025-12-13

### Summary

REST API endpoints for Job management, providing full CRUD operations with pagination, filtering, and search capabilities.

### What's New

- POST /api/v1/jobs - Create new jobs
- GET /api/v1/jobs - List jobs with pagination and filters
- GET /api/v1/jobs/{id} - Retrieve job details
- PUT /api/v1/jobs/{id} - Update job properties
- DELETE /api/v1/jobs/{id} - Delete jobs
- OpenAPI/Swagger documentation for all endpoints
- Search across reference, client, and description fields
- Filter by job status

### Technical Details

- JobService for business logic
- Request/Response DTOs with validation
- 23 integration tests for all endpoints
```

---

## Post-Release

- [x] GitHub release created
- [x] Documentation updated
- [x] CI passing
