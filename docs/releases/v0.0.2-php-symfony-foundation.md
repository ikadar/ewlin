# Release v0.0.2 â€“ PHP/Symfony Project Foundation

> **Status:** ðŸš€ Released
>
> **Milestone:** M0 (Infrastructure & Foundation)
>
> **Target Date:** â€”
>
> **Git Tag:** `v0.0.2`

---

## Overview

This release establishes the PHP/Symfony backend foundation. It sets up Symfony 7 with Doctrine ORM, configured to work with the Docker development environment from v0.0.1.

The project follows a monorepo structure where domain services start as Symfony bundles and can be extracted to separate services later if needed.

---

## Prerequisites

- [x] `v0.0.1` released (Docker environment with MariaDB)
- [x] Docker containers running (`docker compose up -d`)

---

## Scope

### In Scope

- Symfony 7 project initialization
- Monorepo structure with services as bundles
- Doctrine ORM configuration with MariaDB
- Environment configuration (.env structure)
- PHP 8.3+ container for Docker
- Basic health check endpoint

### Out of Scope

- Domain entities (covered in M1)
- API endpoints (covered in M1)
- Authentication/Authorization (covered in M4)
- Production deployment configuration

---

## Related Documentation

### Requirements

| Document | Sections |
|----------|----------|
| [Non-Functional Requirements](../requirements/non-functional-requirements.md) | Performance, Security baselines |

### Architecture

| Document | Sections |
|----------|----------|
| [Decision Records](../architecture/decision-records.md) | [ADR-005: Technology Stack](../architecture/decision-records.md#adr-005--technology-stack-selection) |
| [Service Boundaries](../architecture/service-boundaries.md) | PHP Services section |
| [Project Structure](../architecture/project-structure.md) | Backend layout |

### Roadmap

| Document | Sections |
|----------|----------|
| [Release Roadmap](../roadmap/release-roadmap.md) | Milestone 0, v0.0.2 |

---

## Technical Notes

### Technology Versions

| Technology | Version | Purpose |
|------------|---------|---------|
| PHP | 8.3+ | Runtime |
| Symfony | 7.x | Framework |
| Doctrine ORM | 3.x | Database abstraction |
| Composer | 2.x | Dependency management |

### Project Structure

```
services/
â””â”€â”€ api/
    â”œâ”€â”€ bin/
    â”‚   â””â”€â”€ console
    â”œâ”€â”€ config/
    â”‚   â”œâ”€â”€ bundles.php
    â”‚   â”œâ”€â”€ packages/
    â”‚   â”‚   â”œâ”€â”€ doctrine.yaml
    â”‚   â”‚   â”œâ”€â”€ framework.yaml
    â”‚   â”‚   â””â”€â”€ ...
    â”‚   â”œâ”€â”€ routes.yaml
    â”‚   â””â”€â”€ services.yaml
    â”œâ”€â”€ public/
    â”‚   â””â”€â”€ index.php
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ Controller/
    â”‚   â”œâ”€â”€ Entity/
    â”‚   â”œâ”€â”€ Repository/
    â”‚   â””â”€â”€ Kernel.php
    â”œâ”€â”€ var/
    â”‚   â”œâ”€â”€ cache/
    â”‚   â””â”€â”€ log/
    â”œâ”€â”€ .env
    â”œâ”€â”€ composer.json
    â””â”€â”€ symfony.lock
```

### Bundle Structure (Future)

Services will be organized as bundles:

```
src/
â”œâ”€â”€ StationManagement/
â”‚   â”œâ”€â”€ Controller/
â”‚   â”œâ”€â”€ Entity/
â”‚   â”œâ”€â”€ Repository/
â”‚   â””â”€â”€ StationManagementBundle.php
â”œâ”€â”€ JobManagement/
â”‚   â””â”€â”€ ...
â”œâ”€â”€ Assignment/
â”‚   â””â”€â”€ ...
â””â”€â”€ SchedulingView/
    â””â”€â”€ ...
```

### Docker Integration

PHP container connects to:
- `mariadb` service on port 3306
- `redis` service on port 6379

---

## Feature Checklist

### Symfony Project Setup

- [x] **Create services/api directory**
  - Description: Backend API service directory
  - Files: `services/api/`
  - Tests: Directory exists

- [x] **Initialize Symfony 7 project**
  - Description: Create new Symfony project with webapp skeleton
  - Files: `services/api/composer.json`, `services/api/symfony.lock`
  - Tests: `php bin/console --version` shows Symfony 7.4.2

- [x] **Configure Doctrine ORM**
  - Description: Setup Doctrine with MariaDB connection
  - Files: `services/api/config/packages/doctrine.yaml`
  - Tests: `php bin/console doctrine:database:create` succeeds

- [x] **Configure environment variables**
  - Description: Setup .env with database connection
  - Files: `services/api/.env`, `services/api/.env.local`
  - Tests: Database connection works

### Docker Integration

- [x] **Create PHP Dockerfile**
  - Description: PHP 8.3 FPM with required extensions
  - Files: `docker/php/Dockerfile`
  - Tests: Container builds successfully

- [x] **Add PHP service to docker-compose**
  - Description: PHP-FPM container configuration
  - Files: `docker-compose.yml`
  - Tests: `docker compose ps` shows php service healthy

- [x] **Add Nginx service to docker-compose**
  - Description: Web server for PHP-FPM
  - Files: `docker-compose.yml`, `docker/nginx/default.conf`
  - Tests: HTTP requests reach Symfony

### Health Check

- [x] **Create health check endpoint**
  - Description: GET /health returns status
  - Files: `services/api/src/Controller/HealthController.php`
  - Tests: `curl localhost:8080/health` returns 200

### Documentation

- [x] **Update docker/README.md**
  - Description: Add PHP/Nginx service documentation
  - Files: `docker/README.md`
  - Tests: Documentation is complete

---

## Testing Requirements

### Container Tests

- [x] PHP container starts without errors
- [x] PHP container shows healthy status
- [x] Nginx container starts and serves requests

### Symfony Tests

- [x] `php bin/console --version` returns Symfony 7.4.2
- [x] `php bin/console doctrine:database:create` succeeds (database exists)
- [ ] `php bin/console doctrine:schema:validate` passes (no entities yet)

### Integration Tests

- [x] Health endpoint returns 200: `curl http://localhost:8080/health`
- [x] PHP can connect to MariaDB
- [x] PHP can connect to Redis (extension loaded)

---

## Definition of Done

All items must be checked for the release to be considered complete:

- [x] All feature checklist items completed
- [x] All container tests passing
- [x] All Symfony tests passing (schema validation skipped - no entities yet)
- [x] All integration tests passing
- [x] docker/README.md updated
- [x] CHANGELOG.md updated
- [x] Git tag created: `v0.0.2`

---

## Release Notes Draft

```markdown
## v0.0.2 â€“ PHP/Symfony Project Foundation

**Release Date:** 2025-12-11

### Summary

PHP/Symfony backend foundation with Doctrine ORM, configured to work with
the Docker development environment.

### What's New

- Symfony 7 project in `services/api/`
- PHP 8.3 FPM Docker container
- Nginx web server container
- Doctrine ORM configured for MariaDB
- Health check endpoint at GET /health

### Getting Started

```bash
# Start all services
docker compose up -d

# Verify Symfony
docker compose exec php bin/console --version

# Check health endpoint
curl http://localhost:8080/health
```

### Configuration

Database connection is configured via environment variables in `services/api/.env`:
- `DATABASE_URL=mysql://user:pass@mariadb:3306/flux_scheduler`
```

---

## Post-Release

- [x] GitHub release created
- [ ] Team notified
- [x] Health endpoint accessible
- [x] Next release (v0.0.3) can be started
