# Release v0.0.3 â€“ Node.js Project Foundation

> **Status:** ðŸš€ Released
>
> **Milestone:** M0 (Infrastructure & Foundation)
>
> **Target Date:** â€”
>
> **Git Tag:** `v0.0.3`

---

## Overview

This release establishes the Node.js/TypeScript foundation for the validation service and shared packages. It sets up the monorepo structure with pnpm workspaces, TypeScript configuration, linting, and testing infrastructure.

The Node.js ecosystem will host:
- `@flux/schedule-validator` - Isomorphic validation package (v0.0.4)
- `@flux/task-dsl-parser` - Lezer-based DSL parser (M1)
- Validation Service - Express/Fastify server (M2)

---

## Prerequisites

- [x] `v0.0.2` released (PHP/Symfony foundation)
- [x] Docker containers running (`docker compose up -d`)

---

## Scope

### In Scope

- pnpm workspace configuration
- TypeScript 5.x base configuration
- ESLint 9.x + Prettier setup
- Vitest testing framework
- Shared types package skeleton (`@flux/types`)
- Node.js container for Docker

### Out of Scope

- Validation logic (covered in v0.0.4 and M2)
- Frontend setup (covered in v0.0.5)
- DSL parser (covered in M1)

---

## Related Documentation

### Architecture

| Document | Sections |
|----------|----------|
| [Decision Records](../architecture/decision-records.md) | [ADR-010: Isomorphic Validation](../architecture/decision-records.md#adr-010--isomorphic-validation-service-nodejs) |
| [Release Roadmap](../roadmap/release-roadmap.md) | Milestone 0, v0.0.3 |

---

## Technical Notes

### Technology Versions

| Technology | Version | Purpose |
|------------|---------|---------|
| Node.js | 22 LTS | Runtime |
| pnpm | 9.x | Package manager with workspaces |
| TypeScript | 5.x | Type safety |
| ESLint | 9.x | Linting (flat config) |
| Prettier | 3.x | Code formatting |
| Vitest | 2.x | Testing framework |

### Project Structure

```
services/
â””â”€â”€ node/
    â”œâ”€â”€ packages/
    â”‚   â””â”€â”€ types/                    # @flux/types
    â”‚       â”œâ”€â”€ src/
    â”‚       â”‚   â”œâ”€â”€ index.ts
    â”‚       â”‚   â”œâ”€â”€ station.ts
    â”‚       â”‚   â”œâ”€â”€ job.ts
    â”‚       â”‚   â”œâ”€â”€ task.ts
    â”‚       â”‚   â””â”€â”€ assignment.ts
    â”‚       â”œâ”€â”€ package.json
    â”‚       â””â”€â”€ tsconfig.json
    â”œâ”€â”€ package.json                  # Workspace root
    â”œâ”€â”€ pnpm-workspace.yaml
    â”œâ”€â”€ tsconfig.base.json
    â”œâ”€â”€ eslint.config.js
    â”œâ”€â”€ .prettierrc
    â””â”€â”€ vitest.config.ts
```

### Workspace Structure

The monorepo uses pnpm workspaces:

```yaml
# pnpm-workspace.yaml
packages:
  - 'packages/*'
  - 'apps/*'
```

Future packages:
- `packages/types` - Shared TypeScript types (this release)
- `packages/validator` - Schedule validation (v0.0.4)
- `packages/dsl-parser` - Task DSL parser (M1)
- `apps/validation-service` - HTTP validation service (M2)

---

## Feature Checklist

### Workspace Setup

- [x] **Initialize pnpm workspace**
  - Description: Create workspace root with pnpm
  - Files: `services/node/package.json`, `services/node/pnpm-workspace.yaml`
  - Tests: `pnpm install` succeeds

- [x] **Configure TypeScript**
  - Description: Base TypeScript configuration for all packages
  - Files: `services/node/tsconfig.base.json`
  - Tests: `pnpm build` passes

- [x] **Configure ESLint 9**
  - Description: Flat config ESLint with TypeScript support
  - Files: `services/node/eslint.config.js`
  - Tests: `pnpm lint` passes

- [x] **Configure Prettier**
  - Description: Code formatting configuration
  - Files: `services/node/.prettierrc`
  - Tests: `pnpm format:check` passes

- [x] **Configure Vitest**
  - Description: Testing framework setup
  - Files: `services/node/vitest.config.ts`
  - Tests: `pnpm test` runs (3 tests passing)

### Shared Types Package

- [x] **Create @flux/types package**
  - Description: Shared TypeScript type definitions
  - Files: `services/node/packages/types/package.json`
  - Tests: Package builds successfully

- [x] **Define Station types**
  - Description: Station, StationStatus, OperatingSchedule types
  - Files: `services/node/packages/types/src/station.ts`
  - Tests: Types export correctly

- [x] **Define Job types**
  - Description: Job, JobStatus types
  - Files: `services/node/packages/types/src/job.ts`
  - Tests: Types export correctly

- [x] **Define Task types**
  - Description: Task, TaskStatus, Duration types
  - Files: `services/node/packages/types/src/task.ts`
  - Tests: Types export correctly

- [x] **Define Assignment types**
  - Description: TaskAssignment, ScheduleSnapshot types
  - Files: `services/node/packages/types/src/assignment.ts`
  - Tests: Types export correctly

### Docker Integration

- [x] **Create Node.js Dockerfile**
  - Description: Node.js 22 Alpine container
  - Files: `docker/node/Dockerfile`
  - Tests: Container builds successfully

- [x] **Add Node service to docker-compose**
  - Description: Node.js development container
  - Files: `docker-compose.yml`
  - Tests: `docker compose ps` shows node service

---

## Testing Requirements

### Build Tests

- [x] `pnpm install` completes without errors
- [x] `pnpm build` compiles all packages
- [x] `pnpm lint` passes
- [x] `pnpm format:check` passes
- [x] `pnpm test` runs (3 tests passing)

### Package Tests

- [x] @flux/types exports all defined types
- [x] Types can be imported in other packages

### Docker Tests

- [x] Node container starts without errors
- [x] Node container can run `pnpm install`
- [x] Node container can run `pnpm build`

---

## Definition of Done

All items must be checked for the release to be considered complete:

- [x] All feature checklist items completed
- [x] All build tests passing
- [x] All package tests passing
- [x] All Docker tests passing
- [x] docker/README.md updated
- [x] CHANGELOG.md updated
- [x] Git tag created: `v0.0.3`

---

## Release Notes Draft

```markdown
## v0.0.3 â€“ Node.js Project Foundation

**Release Date:** 2025-12-11

### Summary

Node.js/TypeScript foundation with pnpm workspaces for the validation service
and shared packages ecosystem.

### What's New

- pnpm workspace configuration in `services/node/`
- TypeScript 5.x base configuration
- ESLint 9 with flat config and TypeScript support
- Prettier code formatting
- Vitest testing framework
- `@flux/types` package with domain type definitions
- Node.js 22 Docker container

### Getting Started

```bash
# Start all services
docker compose up -d

# Enter Node container
docker compose exec node sh

# Install dependencies
pnpm install

# Build packages
pnpm build

# Run tests
pnpm test

# Check linting
pnpm lint
```

### Package Structure

- `@flux/types` - Shared TypeScript types (Station, Job, Task, Assignment)
```

---

## Post-Release

- [x] GitHub release created
- [ ] Team notified
- [x] Build passes in container
- [x] Next release (v0.0.4) can be started
