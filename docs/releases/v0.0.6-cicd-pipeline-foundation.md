# Release v0.0.6 – CI/CD Pipeline Foundation

> **Status:** ✅ Completed
>
> **Milestone:** M0 (Infrastructure & Foundation)
>
> **Release Date:** 2025-12-11
>
> **Git Tag:** `v0.0.6`

---

## Overview

This release establishes the CI/CD pipeline foundation using GitHub Actions. The pipeline ensures code quality through automated linting, type checking, testing, and Docker image builds on every push and pull request.

Key features:
- **Lint & Type Check** - ESLint and TypeScript validation for all packages
- **Unit Tests** - Automated test execution with coverage reporting
- **Docker Builds** - Multi-stage image builds for Node.js and PHP services
- **Caching** - Optimized build times with dependency caching

---

## Prerequisites

- [x] `v0.0.5` released (Frontend project foundation)
- [x] Node.js packages with test suites
- [x] Docker configurations for services

---

## Scope

### In Scope

- GitHub Actions workflow configuration
- Node.js lint, type check, and test jobs
- PHP lint job (PHPStan, PHP CS Fixer)
- Docker image build jobs
- Dependency caching for faster builds
- Branch protection rules recommendations

### Out of Scope

- Deployment to staging/production (covered in M4)
- E2E testing (covered in M4)
- Security scanning (covered in M4)
- Release automation (covered in M4)

---

## Related Documentation

### Architecture

| Document | Sections |
|----------|----------|
| [Release Roadmap](../roadmap/release-roadmap.md) | Milestone 0, v0.0.6 |
| [Git Release Strategy](../architecture/git-release-strategy.md) | Branching, CI/CD |

---

## Technical Notes

### Workflow Structure

```
.github/
└── workflows/
    ├── ci.yml              # Main CI workflow
    └── docker.yml          # Docker build workflow
```

### CI Workflow Jobs

```yaml
jobs:
  lint-node:        # ESLint for all Node.js packages
  typecheck-node:   # TypeScript compilation check
  test-node:        # Vitest unit tests
  lint-php:         # PHPStan + PHP CS Fixer
  build-frontend:   # Vite production build
```

### Docker Build Jobs

```yaml
jobs:
  build-node:       # Node.js service image
  build-php:        # PHP-FPM service image
```

### Caching Strategy

| Cache | Key Pattern |
|-------|-------------|
| pnpm store | `pnpm-store-{os}-{hash(pnpm-lock.yaml)}` |
| Composer | `composer-{os}-{hash(composer.lock)}` |
| Docker layers | GitHub Actions cache backend |

### Branch Protection (Recommended)

After this release, configure branch protection on `main`:
- Require status checks to pass
- Require branches to be up to date
- Required checks: `lint-node`, `typecheck-node`, `test-node`

---

## Feature Checklist

### Workflow Setup

- [x] **Create GitHub Actions directory**
  - Description: Initialize .github/workflows structure
  - Files: `.github/workflows/`
  - Tests: Directory exists

### Node.js Jobs

- [x] **Create lint job**
  - Description: Run ESLint on all Node.js packages
  - Files: `.github/workflows/ci.yml`
  - Tests: Job passes on CI

- [x] **Create type check job**
  - Description: Run TypeScript compiler in check mode
  - Files: `.github/workflows/ci.yml`
  - Tests: Job passes on CI

- [x] **Create test job**
  - Description: Run Vitest with coverage
  - Files: `.github/workflows/ci.yml`
  - Tests: Job passes on CI

- [x] **Create frontend build job**
  - Description: Build frontend for production
  - Files: `.github/workflows/ci.yml`
  - Tests: Build artifacts created

### PHP Jobs

- [x] **Create PHP lint job**
  - Description: Run PHPStan (optional, continues on error)
  - Files: `.github/workflows/ci.yml`
  - Tests: Job runs on CI

### Docker Jobs

- [x] **Create Docker build workflow**
  - Description: Build Docker images for services
  - Files: `.github/workflows/docker.yml`
  - Tests: Images build successfully

### Caching

- [x] **Configure pnpm caching**
  - Description: Cache pnpm store for faster installs
  - Files: `.github/workflows/ci.yml`
  - Tests: Cache hit on subsequent runs

- [x] **Configure Composer caching**
  - Description: Cache Composer dependencies
  - Files: `.github/workflows/ci.yml`
  - Tests: Cache hit on subsequent runs

---

## Definition of Done

- [x] All feature checklist items completed
- [x] CI workflow runs on push and pull_request
- [x] All jobs configured for current codebase
- [x] Caching configured for faster builds
- [x] CHANGELOG.md updated
- [x] Git tag created: `v0.0.6`

---

## Release Notes Draft

```markdown
## v0.0.6 – CI/CD Pipeline Foundation

**Release Date:** 2025-12-11

### Summary

GitHub Actions CI/CD pipeline for automated quality checks and builds.

### What's New

- CI workflow with lint, type check, and test jobs
- Docker build workflow for service images
- Dependency caching for faster builds
- Frontend production build verification

### Workflows

| Workflow | Trigger | Jobs |
|----------|---------|------|
| CI | push, pull_request | lint, typecheck, test, build |
| Docker | push to main, tags | build-node, build-php |

### Branch Protection

Recommended settings for `main` branch:
- Require status checks: `lint-node`, `typecheck-node`, `test-node`
- Require branches to be up to date before merging
```

---

## Post-Release

- [ ] GitHub Actions workflows visible in repository
- [ ] All checks passing on main branch
- [ ] Branch protection rules configured
- [ ] Next milestone (M1) can be started
