# Release v0.3.17 – Keyboard Shortcuts

> **Status:** ✅ Released
>
> **Milestone:** M3 (Frontend Integration)
>
> **Target Date:** 2025-12-16
>
> **Git Tag:** `v0.3.17`

---

## Overview

Keyboard shortcuts for efficient navigation within the scheduling grid and job list. Enables power users to navigate quickly without mouse interaction, integrating with Quick Placement Mode for rapid scheduling workflows.

---

## Prerequisites

- [x] v0.3.16 - Quick Placement Mode released
- [x] Job selection functionality
- [x] Date strip with scroll-to-date capability
- [x] SchedulingGrid with scrollable viewport

---

## Scope

### In Scope

- **ALT+Q** - Toggle Quick Placement Mode (already implemented in v0.3.16)
- **ALT+D** - Jump to selected job's departure date
- **ALT+↑** - Select previous job in list
- **ALT+↓** - Select next job in list
- **Home** - Jump to today
- **Page Up** - Scroll grid up by one day
- **Page Down** - Scroll grid down by one day

### Out of Scope

- ALT+←/→ column navigation (no clear use case identified)
- Arrow key tile-to-tile navigation (post-MVP)
- Custom shortcut configuration (post-MVP)

---

## Related Documentation

### UX/UI Specification

| Document | Sections |
|----------|----------|
| [Grid Navigation](../ux-ui/03-navigation/grid-navigation.md) | Keyboard shortcuts table |
| [Job Navigation](../ux-ui/03-navigation/job-navigation.md) | ALT+↑/↓ behavior |
| [Backward Scheduling](../ux-ui/03-navigation/backward-scheduling.md) | ALT+D behavior |
| [Date Navigation Strip](../ux-ui/03-navigation/date-navigation-strip.md) | Click to jump |

### Domain Model

| Document | Sections |
|----------|----------|
| [Business Rules](../domain-model/business-rules.md) | Job selection, navigation |

---

## Technical Notes

### Scroll Implementation

The grid scroll uses the SchedulingGrid component. To scroll to a specific time:

```typescript
// Calculate Y position from time
const PIXELS_PER_HOUR = 120; // From TimelineColumn
const START_HOUR = 6;

function timeToYPosition(time: Date): number {
  const hours = time.getHours() + time.getMinutes() / 60;
  return (hours - START_HOUR) * PIXELS_PER_HOUR;
}
```

### Job Navigation Logic

Navigate through the filtered/sorted job list:
- Use the same order as displayed in JobsList
- Wrap around at boundaries (last → first, first → last)
- If no job is selected, select the first one

### Date Calculations

For Page Up/Down, scroll by one full day (24 * PIXELS_PER_HOUR = 2880px).

For ALT+D (jump to departure date):
- Get selected job's `workshopExitDate`
- Position the date at the **bottom** of the viewport (backward scheduling workflow)

---

## Feature Checklist

### Job Navigation

- [x] **ALT+↑ previous job handler**
  - Description: Select the previous job in the job list
  - Files: `apps/web/src/App.tsx`

- [x] **ALT+↓ next job handler**
  - Description: Select the next job in the job list
  - Files: `apps/web/src/App.tsx`

- [x] **Job list order calculation**
  - Description: Get ordered list of job IDs matching JobsList display order
  - Files: `apps/web/src/App.tsx`

### Grid Navigation

- [x] **Home key handler**
  - Description: Scroll grid to current date/time (today)
  - Files: `apps/web/src/App.tsx`, `apps/web/src/components/SchedulingGrid/SchedulingGrid.tsx`

- [x] **Page Up handler**
  - Description: Scroll grid up by one day
  - Files: `apps/web/src/App.tsx`, `apps/web/src/components/SchedulingGrid/SchedulingGrid.tsx`

- [x] **Page Down handler**
  - Description: Scroll grid down by one day
  - Files: `apps/web/src/App.tsx`, `apps/web/src/components/SchedulingGrid/SchedulingGrid.tsx`

- [x] **ALT+D jump to departure handler**
  - Description: Scroll grid to selected job's departure date (at bottom of viewport)
  - Files: `apps/web/src/App.tsx`, `apps/web/src/components/SchedulingGrid/SchedulingGrid.tsx`

### Integration

- [x] **Expose grid scroll ref from SchedulingGrid**
  - Description: Add ref forwarding or callback for programmatic scrolling
  - Files: `apps/web/src/components/SchedulingGrid/SchedulingGrid.tsx`

- [x] **Pass scroll callbacks to App**
  - Description: Allow App to trigger grid scrolling
  - Files: `apps/web/src/App.tsx`, `apps/web/src/components/SchedulingGrid/SchedulingGrid.tsx`

---

## Testing Requirements

### Unit Tests

- [x] Job navigation wraps from last to first
- [x] Job navigation wraps from first to last
- [x] Job navigation selects first job when none selected
- [x] timeToYPosition calculates correct pixel offset

### Integration Tests

- [x] ALT+↑ changes selected job
- [x] ALT+↓ changes selected job
- [x] Home key scrolls to today
- [x] Page Up/Down scrolls by correct amount

### Manual Testing

- [x] ALT+↑/↓ navigates through job list
- [x] ALT+D scrolls to departure date at bottom of viewport
- [x] Home key shows current time in view
- [x] Page Up/Down scrolls smoothly by one day
- [x] Shortcuts work in Quick Placement Mode
- [x] No conflict with browser default shortcuts

---

## Definition of Done

All items must be checked for the release to be considered complete:

- [x] All feature checklist items completed
- [x] All unit tests passing
- [x] TypeScript compiles without errors
- [x] Lint passes
- [x] Documentation updated
- [x] Merged to ux-ui-development branch

---

## Release Notes Draft

```markdown
## v0.3.17 – Keyboard Shortcuts

**Release Date:** 2025-12-16

### Summary

Keyboard shortcuts for efficient navigation. Navigate between jobs with ALT+↑/↓, jump to today with Home, scroll by day with Page Up/Down, and jump to a job's departure date with ALT+D.

### What's New

- ALT+↑: Select previous job
- ALT+↓: Select next job
- ALT+D: Jump to departure date (backward scheduling)
- Home: Jump to today
- Page Up: Scroll up by one day
- Page Down: Scroll down by one day

### Technical

- Grid scroll ref forwarding for programmatic control
- Job list navigation with wrap-around
- Integration with Quick Placement Mode
```

---

## File Structure

```
apps/web/src/
├── App.tsx                              # Keyboard handlers, job navigation
├── components/
│   └── SchedulingGrid/
│       └── SchedulingGrid.tsx           # Scroll ref, programmatic scrolling
```
